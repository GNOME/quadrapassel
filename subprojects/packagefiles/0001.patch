From 45b51d6b16b3e35a37a67b04fc9742ed6569d7b1 Mon Sep 17 00:00:00 2001
From: Will Warner <willwwarner@proton.me>
Date: Sat, 8 Nov 2025 08:27:08 -0500
Subject: [PATCH] Revert "Remove add_scores_internal()"

This reverts commit dee87de9e5aefe491bb168557333e8e8d97c89b9.
---
 games/scores/context.vala | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/games/scores/context.vala b/games/scores/context.vala
index b677b1c..77e0b6e 100644
--- a/games/scores/context.vala
+++ b/games/scores/context.vala
@@ -273,6 +273,23 @@ public class Context : Object
         yield stream.write_all_async (line.data, Priority.DEFAULT, cancellable, null);
     }
 
+    /* This is separate from add_score() for use by HistoryFileImporter.
+     * At the next API break, we should merge this into add_score().
+     */
+    internal async bool add_score_internal (Score score, Category category, Cancellable? cancellable) throws Error
+    {
+        /* Check if category exists in the HashTable. Insert one if not. */
+        if (!scores_per_category.has_key (category))
+            scores_per_category.set (category, new Gee.ArrayList<Score> ());
+
+        if (scores_per_category[category].add (score))
+            current_category = category;
+
+        var high_score_added = is_high_score (score.score, category);
+        yield save_score_to_file (score, category, cancellable);
+        return high_score_added;
+    }
+
     /**
      * Returns true if a dialog was launched on attaining high score.
      *
-- 
