From 7e12afa24b9e74bd33ff6c2a5d0ecf30594aa3b2 Mon Sep 17 00:00:00 2001
From: Will Warner <willwwarner@proton.me>
Date: Mon, 15 Dec 2025 15:05:28 -0500
Subject: [PATCH] Revert "Remove add_scores_internal()"

This reverts commit dee87de9e5aefe491bb168557333e8e8d97c89b9.
---
 games/scores/context.vala | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/games/scores/context.vala b/games/scores/context.vala
index c802d6a..2f1f160 100644
--- a/games/scores/context.vala
+++ b/games/scores/context.vala
@@ -273,6 +273,24 @@ public class Context : Object
         yield stream.write_all_async (line.data, Priority.DEFAULT, cancellable, null);
     }

+    /* This is separate from add_score() for use by HistoryFileImporter.
+     * At the next API break, we should merge this into add_score().
+     */
+    internal async bool add_score_internal (Score score, Category category, Cancellable? cancellable) throws Error
+    {
+        /* Check if category exists in the HashTable. Insert one if not. */
+        if (!scores_per_category.contains (category))
+            scores_per_category[category] = new GenericArray<Score> ();
+
+        scores_per_category[category].add (score);
+        current_category = category;
+
+        var high_score_added = is_high_score (score.score, category);
+
+        yield save_score_to_file (score, category, cancellable);
+        return high_score_added;
+    }
+
     /**
      * Returns true if a dialog was launched on attaining high score.
      *
--
